-# file: app/views/courses/index.html.haml

%p#notice=notice

.row
  .col-xs-12
    %h1{class:"text-left"}="Course Overview "

.row
  .col-xs-6=link_to "New Course",new_course_path,class:"btn btn-primary"

%table#courses.table.table-striped{:class => "table table-hover"}
  %thead
    %tr
      %th Couse ID
      %th Course-Name 
      %th Credits
      %th Lecturer
      %th Description
      %th Edit
  %tbody
    - @courses.each do |course|
      %tr{:id => "accordion-parent-#{course.id}", :class => 'clickable', "data-toggle" => "collapse", "data-target" => "#accordion-#{course.id}"}
        %td= course.cid
        %td= course.name
        %td= course.credits
        %td= course.lecturer
        %td= course.description
        %td=link_to 'Edit', edit_course_path(course.id)
      %tr{:id => "accordion-#{course.id}", :class => 'collapse', "data-parent" => "accordion-parent-#{course.id}"}
        %td
        %td{:colspan => 5}
          %table#courses.table.table-striped
            %thead
              %tr
                %th TA Name
                %th Status
                %th Action 
              -if @courses_ta[course.id]
                -@courses_ta[course.id].each do |ta|
                  %tr
                    %td= link_to ta.fullName(), '#myModal-#{course.id}-#{ta.id}', "data-toggle" => "modal",  "data-target" => "#myModal-#{course.id}-#{ta.id}"
                    %td
                      - case ta.status
                        - when Student::UNDER_REVIEW
                          %span{class:"label label-default"}="Under Review"
                        - when Student::TEMP_ASSIGNED
                          %span{class:"label label-primary"}="Temporary Assigned"
                        - when Student::EMAIL_NOTIFIED
                          %span{class:"label label-primary"}="Email Notified"
                        - when Student::STUDENT_CONFIRMED
                          %span{class:"label label-success"}="Student Confirmed"
                        - when Student::STUDENT_REJECTED
                          %span{class:"label label-warning"}="Student Rejected"
                        - when Student::ASSIGNED
                          %span{class:"label label-success"}="Assigned"
                        - else
                          %span{class:"label label-danger"}="Unknown"
                    %td=link_to('Email', email_ta_notification_path(:id => course.id, :ta_id => ta.id)) +' / ' + link_to('Confirm', confirm_ta_path(:id => course.id, :ta_id => ta.id)) +' / ' +link_to('Delete', delete_ta_path(:id => course.id, :ta_id => ta.id))
              %tr
                %td{:colspan => 2}
                %td=link_to 'Assign new TA', select_new_ta_path(course.id)


- @courses.each do |course|
  -if @courses_ta[course.id]
    -@courses_ta[course.id].each do |student|
      %div{class:"modal fade", "id" => "myModal-#{course.id}-#{student.id}", "tabindex" => "-1", "role" => "dialog",  "aria-labelledby" => "myModalLabel"}
        %div{class:"modal-dialog", :role => "document"}
          %div{class:"modal-content"}
            %div{class:"modal-header"} 
              %h2 #{student.fullName()}'s Application Form
            %div{class:"modal-body"}
              %table#student.table.table-striped
                %thead
                  %tr
                    %th Field
                    %th Info
                %tbody
                  %tr
                    %td UIN
                    %td= student.uin
                  %tr
                    %td Name
                    %td= student.fullName()
                  %tr
                    %td Advisor
                    %td= student.advisor
                  %tr
                    %td Degree
                    %td= student.degree
                  %tr
                    %td GPA
                    %td= student.gpa
                  %tr
                    %td Course Taken
                    %td= student.course_taken
                  %tr
                    %td Course TAed
                    %td= student.course_taed